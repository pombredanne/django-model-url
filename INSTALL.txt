h1. Install

h2. Required

django-url-methods

h2. Buildout

<pre>
[buildout]
parts = ...
        django-url-methods
        django-model-url
        
[django]
...
extra-paths = ...
              ${django-url-methods:location}
              ${django-model-url:location}

[django-url-methods]
recipe = zerokspot.recipe.git
repository = ssh://verne.redsolution.ru/srv/git/django-url-methods.git

[django-model-url]
recipe = zerokspot.recipe.git
repository = ssh://verne.redsolution.ru/srv/git/django-model-url.git
</pre>

h2. settings.py

<pre>
MIDDLEWARE_CLASSES = [
    ...
    'modelurl.middleware.ModelUrlMiddleware',
]
...
INSTALLED_APPS = (
...
    'modelurl',
)
...
MODELURL_MODELS = [
    {
        'model': 'myapp.models.MyModel',
    },
]
MODELURL_VIEWS = [
    {
        'view': 'django.contrib.admin.site.root',
        'disable': True,
    },
    {
        'view': 'myapp.views.get',
        'context': 'object',
    },
]
...
</pre>


h2. myapp/models.py

<pre>
from modelurl.utils import ReplaceByView

class MyModel(models.Model):
    url = models.CharField(max_length=200)
    ...
    def save(self, *args, **kwargs):
        url = ReplaceByView(silent=True).url(url)
        super(MyModel, self).save(*args, **kwargs)
</pre>

h2. Using with django-trusted-html

<pre>
from trustedhtml.signals import rule_done
from trustedhtml.classes import Uri
from modelurl.utils import ReplaceByView

def url_done(sender, rule, value, source, **kwargs):
    return ReplaceByView(silent=True).url(value)

rule_done.connect(url_done, sender=Uri)
</pre>
